(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-49d39a2a"],{"0e8f":function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return s})),a.d(t,"d",(function(){return l}));a("99af");var r=a("b775"),n="",i=function(){return Object(r["c"])("".concat(n,"/api-user/department/findAll"))},o=function(e){return Object(r["b"])("".concat(n,"/api-user/department/").concat(e))};function s(e){return Object(r["a"])({url:"".concat(n,"/api-user/department/saveOrUpdate"),method:"post",isJson:!0,data:JSON.stringify(e)})}var l=function(e){return Object(r["c"])("".concat(n,"/api-user/department/editName"),e)}},"13c4":function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return s}));var r=a("b775"),n="";function i(e){return Object(r["a"])({url:"".concat(n,"/api-project/project/findProjects"),method:"get",params:e})}function o(e){return Object(r["a"])({url:"".concat(n,"/api-project/project/saveOrUpdate"),method:"post",isJson:!0,data:JSON.stringify(e)})}function s(e){return Object(r["a"])({url:"".concat(n,"/api-project/project/saveOrUpdate"),method:"post",isJson:!0,data:JSON.stringify(e)})}},3183:function(e,t,a){},"4f63":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("section",{staticClass:"search-container"},[a("el-form",{staticClass:"search-form-wrap",attrs:{size:"small","label-width":"80px","label-position":"right",model:e.searchForm}},[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"项目名"}},[a("el-input",{attrs:{placeholder:"项目名"},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"所属部门"}},[a("org-tree",{ref:"orgTreeDom",staticStyle:{width:"100%"},attrs:{"corp-id":e.corpId},model:{value:e.searchForm.departmentId,callback:function(t){e.$set(e.searchForm,"departmentId",t)},expression:"searchForm.departmentId"}})],1)],1),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"search-form_btn"},[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.searchData}},[e._v("查询")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"primary"},on:{click:e.resetData}},[e._v("重置")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:e.createProject}},[e._v("创建项目")])],1)])],1)],1)],1),a("div",{staticClass:"divide-line"}),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticClass:"table-container mt-20",staticStyle:{width:"100%"},attrs:{"header-cell-style":e.tableHeaderColor,data:e.tableList}},[a("el-table-column",{attrs:{prop:"name",label:"项目名","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{prop:"description",label:"描述","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{prop:"department",label:"部门","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{prop:"projectMembers",label:"项目成员","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"创建时间","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("formateDate")(t.row.createTime))+" ")]}}])}),a("el-table-column",{attrs:{prop:"hive",label:"配置项目hive库","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"edit-wrapper",on:{click:function(a){return a.stopPropagation(),e.updateTableData(t.row)}}},[e._v("编辑")])]}}])})],1),a("el-pagination",{staticClass:"g-zv-pagination",attrs:{"current-page":e.pages.pageNum,"page-size":e.pages.pageSize,"page-sizes":[5,10,15,20,30,50,100],layout:"total, sizes, prev, pager, next, jumper",total:e.pages.total},on:{"update:currentPage":function(t){return e.$set(e.pages,"pageNum",t)},"update:current-page":function(t){return e.$set(e.pages,"pageNum",t)},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{key:e.dialogId,attrs:{title:e.modalOption.title,visible:e.modalOption.show,width:"30%",center:"","destroy-on-close":!0,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){return e.$set(e.modalOption,"show",t)}}},[a("el-form",{ref:"plantRadiationForm",attrs:{size:"small",model:e.dataForm,rules:e.dataFormRules,"label-width":"120px","label-position":"left"}},[a("el-form-item",{attrs:{label:"项目名",prop:"name"}},[a("el-input",{attrs:{maxlength:20,disabled:e.isDisable},model:{value:e.dataForm.name,callback:function(t){e.$set(e.dataForm,"name",t)},expression:"dataForm.name"}})],1),a("el-form-item",{attrs:{label:"描述",prop:"description"}},[a("el-input",{attrs:{maxlength:20,disabled:e.isDisable},model:{value:e.dataForm.description,callback:function(t){e.$set(e.dataForm,"description",t)},expression:"dataForm.description"}})],1),a("el-form-item",{attrs:{label:"部门",prop:"departmentId"}},[a("org-tree",{ref:"departmentTreeDom",staticStyle:{width:"100%"},model:{value:e.dataForm.departmentId,callback:function(t){e.$set(e.dataForm,"departmentId",t)},expression:"dataForm.departmentId"}})],1)],1),a("div",{staticClass:"dialog_footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return t.stopPropagation(),e.cancelClick(t)}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return t.stopPropagation(),e.confirmClick(t)}}},[e._v("确定")])],1)],1)],1)},n=[],i=(a("b0c0"),a("d3b7"),a("a4d3"),a("e01a"),a("7bbf")),o=a("13c4"),s={name:"ProjectList",components:{OrgTree:i["a"]},data:function(){return{searchForm:{name:"",departmentId:""},pages:{pageNum:1,pageSize:10},tableLoading:!1,tableList:[{name:"深圳市前海大厦XXX项目",description:"这是一个描述，这是一个描述，这...",adminName:"李四",department:"IT运维部",projectMembers:"李四",createTime:"2021-07-05",hive:"配置项目hive库"}],dialogId:1,modalOption:{show:!1,title:"创建项目"},dataForm:{name:"",description:"",departmentId:null},corpId:1,isDisable:!1,dataFormRules:{name:[{required:!0,message:"请输入项目名",trigger:"blur"}],description:[{required:!0,message:"请输入描述",trigger:"blur"}],departmentId:[{required:!0,message:"请选择部门",trigger:"blur"}]}}},mounted:function(){this.$refs["orgTreeDom"].fnClear(),this.getDataList()},methods:{getDataList:function(){var e=this;this.tableLoading=!0;var t={page:this.pages.pageNum,limit:this.pages.pageSize,name:this.searchForm.name,departmentId:this.searchForm.departmentId};Object(o["b"])(t).then((function(t){e.pages.total=null===t||void 0===t?void 0:t.count,e.tableList=(null===t||void 0===t?void 0:t.data)||[]})).catch((function(){})).finally((function(){e.tableLoading=!1}))},searchData:function(){this.pages.pageNum=1,this.getDataList()},resetData:function(){var e=this;this.pages.pageNum=1,this.searchForm.name="",this.searchForm.departmentId="",this.$nextTick((function(){e.corpId=0,e.$refs["orgTreeDom"].fnClear()})),this.getDataList()},handleCurrentChange:function(e){this.pages.pageNum=e,this.getDataList()},handleSizeChange:function(e){this.pages.pageSize=e,this.getDataList()},createProject:function(){this.dialogId++,this.dataForm={name:"",description:"",departmentId:0},this.modalOption.title="创建项目",this.modalOption.show=!0},createMethod:function(e){var t=this;Object(o["a"])(e).then((function(e){t.$message({type:"success",message:"新建成功!"}),t.cancelClick(),t.pages.pageNum=1,t.getDataList()})).catch((function(){}))},updateTableData:function(e){this.dialogId++,this.dataForm={id:e.id,name:e.name,description:e.description,departmentId:e.departmentId},this.modalOption.title="编辑项目",this.modalOption.show=!0},updateMethod:function(e){var t=this;Object(o["c"])(e).then((function(e){t.$message({type:"success",message:"修改成功!"}),t.cancelClick(),t.pages.pageNum=1,t.getDataList()})).catch((function(){}))},confirmClick:function(){var e=this;this.$refs["plantRadiationForm"].validate((function(t){if(!t)return!1;var a=Object.assign({},e.dataForm);"创建项目"===e.modalOption.title?e.createMethod(a):(a.id=e.currentId,e.updateMethod(a))}))},cancelClick:function(){this.$refs["plantRadiationForm"].resetFields(),this.modalOption.show=!1},goTo:function(e){/^http/.test(e)?window.location.href=e:this.$router.push(e)}}},l=s,c=(a("be7c"),a("2877")),d=Object(c["a"])(l,r,n,!1,null,"e97a4754",null);t["default"]=d.exports},"67e26":function(e,t,a){},"7bbf":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-tree-select",{ref:"treeSelect",attrs:{loading:e.loading,clearable:e.clearable,"only-child":e.onlyChild,"tree-data":e.treeData},model:{value:e.currentValue,callback:function(t){e.currentValue=t},expression:"currentValue"}})},n=[],i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-select",{ref:"select",attrs:{value:e.currentValuet,loading:e.loading,clearable:e.clearable},on:{clear:e.clearData}},[a("el-option",{staticClass:"dropdown__tree",attrs:{value:0,label:e.currentLabel}},[a("el-tree",{ref:"tree",attrs:{data:e.treeData,props:e.defaultProps,"node-key":"id","highlight-current":"",accordion:"","default-expanded-keys":[e.pid]},on:{"node-click":e.handleNodeClick}})],1)],1)},o=[],s=(a("b0c0"),{components:{},name:"vTreeSelect",props:{value:{required:!0},loading:{type:Boolean},clearable:{type:Boolean},treeData:{required:!0,type:Array},onlyChild:{type:Boolean,default:!1}},data:function(){return{currentLabel:void 0,pid:void 0,defaultProps:{children:"subs",label:"name"}}},computed:{currentValuet:function(){if(this.pid="",null!==this.value&&void 0!==this.value){var e=this.currentNode(this.treeData,this.value);return this.pid=!0===e||void 0===e?"":e,0}this.pid=""}},methods:{currentNode:function(e,t){for(var a in e){if(e[a].id===t)return this.selectNode(e[a]),!0;if(e[a].subs&&e[a].subs.length>0){var r=this.currentNode(e[a].subs,t);if(void 0!==r)return!0===r?e[a].id:r}}},handleNodeClick:function(e){return(!this.onlyChild||(!e.subs||0===e.subs.length))&&this.$emit("input",parseInt(e.id))},selectNode:function(e){var t=this;this.$nextTick((function(){t.$refs["tree"].setCurrentKey(e.id)})),this.$refs["select"]&&(this.$refs["select"].visible=!1),this.currentLabel=e.name},clearData:function(){this.$emit("input",void 0)}}}),l=s,c=(a("80ad"),a("2877")),d=Object(c["a"])(l,i,o,!1,null,null,null),u=d.exports,p=a("0e8f"),m={name:"OrgTree",components:{vTreeSelect:u},props:{value:{required:!0},corpId:{required:!1},clearable:{type:Boolean},onlyChild:{type:Boolean}},computed:{currentValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},data:function(){return{loading:!1,treeData:[]}},methods:{refresh:function(){var e=this;this.loading=!0,Object(p["c"])().then((function(t){e.loading=!1,e.treeData=[{subs:t,id:0,name:"部门"}]}))},fnClear:function(){this.$refs["treeSelect"].clearData()}},created:function(){this.refresh()},mounted:function(){var e=this;this.$refs["treeSelect"].$on("nodeClick",(function(t){e.$emit("nodeClick",t)}))}},h=m,f=Object(c["a"])(h,r,n,!1,null,null,null);t["a"]=f.exports},"80ad":function(e,t,a){"use strict";a("3183")},be7c:function(e,t,a){"use strict";a("67e26")}}]);