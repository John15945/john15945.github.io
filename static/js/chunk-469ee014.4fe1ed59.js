(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-469ee014"],{"1bf1":function(a,e,t){"use strict";t.r(e);var s=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"container"},[t("section",{staticClass:"search-container"},[t("el-form",{staticClass:"search-form-wrap",attrs:{size:"small","label-width":"100px","label-position":"right",model:a.searchForm}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"数据源类型"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{clearable:""},model:{value:a.searchForm.datasourceType,callback:function(e){a.$set(a.searchForm,"datasourceType",e)},expression:"searchForm.datasourceType"}},[a.dataSourceTypeList.length>0?a._l(a.dataSourceTypeList,(function(e,s){return t("el-option",{key:s,attrs:{value:e}},[a._v(" "+a._s(e)+" ")])})):a._e()],2)],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"名称"}},[t("el-input",{attrs:{placeholder:"名称"},model:{value:a.searchForm.name,callback:function(e){a.$set(a.searchForm,"name",e)},expression:"searchForm.name"}})],1)],1),t("el-col",{attrs:{span:12}},[t("div",{staticClass:"search-form_btn"},[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:a.fnSearch}},[a._v("搜索")]),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"primary"},on:{click:a.resetData}},[a._v("重置")]),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:a.createDataSource}},[a._v("数据源添加")])],1)])],1)],1)],1),t("div",{staticClass:"divide-line"}),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:a.tableLoading,expression:"tableLoading"}],staticClass:"table-container mt-20",staticStyle:{width:"100%"},attrs:{border:"","header-cell-style":a.tableHeaderColor,data:a.tableList}},[t("el-table-column",{attrs:{prop:"datasourceType",label:"数据源类型","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{prop:"name",label:"名称","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{prop:"description",label:"描述","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{prop:"keytabUrl",label:"连接URL","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{prop:"username",label:"用户名","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{prop:"dbName",label:"数据库名","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("span",{staticClass:"edit-wrapper",on:{click:function(t){return t.stopPropagation(),a.updateTableData(e.row)}}},[a._v("编辑")]),t("span",{staticClass:"edit-wrapper ml-5",on:{click:function(t){return t.stopPropagation(),a.synchronizeData(e.row)}}},[a._v("同步")]),t("span",{staticClass:"edit-wrapper ml-5",on:{click:function(t){return t.stopPropagation(),a.deleteTableData(e.row)}}},[a._v("移除")])]}}])})],1),t("el-pagination",{staticClass:"g-zv-pagination",attrs:{"current-page":a.pages.pageNum,"page-size":a.pages.pageSize,"page-sizes":[5,10,15,20,30,50,100],layout:"total, sizes, prev, pager, next, jumper",total:a.pages.total},on:{"update:currentPage":function(e){return a.$set(a.pages,"pageNum",e)},"update:current-page":function(e){return a.$set(a.pages,"pageNum",e)},"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}}),t("el-dialog",{key:a.dialogId,attrs:{title:a.modalOption.title,visible:a.modalOption.show,width:"30%",center:"","destroy-on-close":!0,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){return a.$set(a.modalOption,"show",e)}}},[t("el-form",{ref:"plantRadiationForm",attrs:{size:"small",model:a.dataForm,rules:a.dataFormRules,"label-width":"120px","label-position":"left"}},[t("el-form-item",{attrs:{label:"数据源类型",prop:"datasourceType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{disabled:a.isDisable,clearable:""},on:{change:a.fnChangeType},model:{value:a.dataForm.datasourceType,callback:function(e){a.$set(a.dataForm,"datasourceType",e)},expression:"dataForm.datasourceType"}},[a.dataSourceTypeList.length>0?a._l(a.dataSourceTypeList,(function(e,s){return t("el-option",{key:s,attrs:{value:e}},[a._v(" "+a._s(e)+" ")])})):a._e()],2)],1),t("el-form-item",{attrs:{label:"命名",prop:"name"}},[t("el-input",{attrs:{clearable:"",maxlength:20},model:{value:a.dataForm.name,callback:function(e){a.$set(a.dataForm,"name",e)},expression:"dataForm.name"}})],1),t("el-form-item",{attrs:{label:"描述"}},[t("el-input",{attrs:{clearable:"",maxlength:20},model:{value:a.dataForm.description,callback:function(e){a.$set(a.dataForm,"description",e)},expression:"dataForm.description"}})],1),t("el-form-item",{attrs:{label:"链接URL"}},[t("el-input",{attrs:{clearable:"",maxlength:20},model:{value:a.dataForm.keytabUrl,callback:function(e){a.$set(a.dataForm,"keytabUrl",e)},expression:"dataForm.keytabUrl"}})],1),t("el-form-item",{attrs:{label:"用户名"}},[t("el-input",{attrs:{clearable:"",maxlength:20},model:{value:a.dataForm.username,callback:function(e){a.$set(a.dataForm,"username",e)},expression:"dataForm.username"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{clearable:"",maxlength:20},model:{value:a.dataForm.password,callback:function(e){a.$set(a.dataForm,"password",e)},expression:"dataForm.password"}})],1),t("el-form-item",{attrs:{label:"数据库名"}},[t("el-input",{attrs:{clearable:"",maxlength:20},model:{value:a.dataForm.dbName,callback:function(e){a.$set(a.dataForm,"dbName",e)},expression:"dataForm.dbName"}})],1)],1),t("div",{staticClass:"dialog_footer",attrs:{slot:"footer"},slot:"footer"},[t("el-link",{staticStyle:{"font-size":"12px","margin-right":"10px"},attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),a.test(e)}}},[a._v("连接测试")]),t("el-button",{attrs:{size:"small"},on:{click:function(e){return e.stopPropagation(),a.cancelClick(e)}}},[a._v("取消")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return e.stopPropagation(),a.confirmClick(e)}}},[a._v("确定")])],1)],1)],1)},o=[],r=(t("b0c0"),t("d3b7"),t("a4d3"),t("e01a"),t("99af"),t("b775")),n="";function i(a){return Object(r["a"])({url:"".concat(n,"/api-dataManage/datasource/findDatasources"),method:"get",params:a})}function l(a){return Object(r["a"])({url:"".concat(n,"/api-dataManage/datasource/findAllDbTypes"),method:"get",params:a})}function c(a){return Object(r["a"])({url:"".concat(n,"/api-dataManage/datasource/delete/").concat(a),method:"delete"})}function d(a){return Object(r["a"])({url:"".concat(n,"/api-dataManage/datasource/addOrUpdate"),method:"post",isJson:!0,data:JSON.stringify(a)})}function p(a){return Object(r["a"])({url:"".concat(n,"/api-dataManage/datasource/addOrUpdate"),method:"post",isJson:!0,data:JSON.stringify(a)})}function u(a){return Object(r["a"])({url:"".concat(n,"/api-dataManage/datasource/connTest"),method:"post",isJson:!0,data:JSON.stringify(a)})}var m={name:"DataSourceManagement",data:function(){return{searchForm:{datasourceType:"",name:""},pages:{pageNum:1,pageSize:10},tableLoading:!1,tableList:[],dialogId:1,modalOption:{show:!1,title:"数据源添加"},isDisable:!1,dataSourceTypeList:[],currentPassword:"",dataForm:{datasourceType:"",name:"",description:"",keytabUrl:"",username:"",password:"",dbName:""},dataFormRules:{datasourceType:[{required:!0,message:"请输入数据源类型",trigger:"blur"}],name:[{required:!0,message:"请输入命名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},mounted:function(){this.getDataList(),this.queryDbList()},methods:{queryDbList:function(){var a=this;l().then((function(e){a.dataSourceTypeList=e})).catch((function(a){}))},getDataList:function(){var a=this;this.tableLoading=!0;var e={page:this.pages.pageNum,limit:this.pages.pageSize,datasourceType:this.searchForm.datasourceType,name:this.searchForm.name};i(e).then((function(e){a.pages.total=null===e||void 0===e?void 0:e.count,a.tableList=(null===e||void 0===e?void 0:e.data)||[]})).catch((function(){})).finally((function(){a.tableLoading=!1}))},fnSearch:function(){this.page=1,this.getDataList()},resetData:function(){this.page=1,this.searchForm.datasourceType="",this.searchForm.name="",this.getDataList()},handleCurrentChange:function(a){this.pages.pageNum=a,this.getDataList()},handleSizeChange:function(a){this.pages.pageSize=a,this.getDataList()},fnChangeType:function(a){this.dataForm.datasourceType=a},createDataSource:function(){this.dialogId++,this.dataForm={datasourceType:"",name:"",description:"",keytabUrl:"",username:"",password:"",dbName:""},this.modalOption.title="数据源添加",this.modalOption.show=!0,this.isDisable=!1},createMethod:function(a){var e=this;d(a).then((function(a){0===a.resp_code&&(e.$message({type:"success",message:"新建成功!"}),e.cancelClick(),e.pages.pageNum=1,e.getDataList())})).catch((function(){}))},updateTableData:function(a){this.dialogId++,this.dataForm={id:a.id,datasourceType:a.datasourceType||"",name:a.name||"",description:a.description||"",keytabUrl:a.keytabUrl||"",username:a.username||"",password:a.password||"",dbName:a.dbName||""},this.currentPassword=a.password,this.modalOption.title="编辑",this.modalOption.show=!0,this.isDisable=!0},updateMethod:function(a){var e=this;p(a).then((function(a){0===a.resp_code&&(e.$message({type:"success",message:"修改成功!"}),e.cancelClick(),e.pages.pageNum=1,e.getDataList())})).catch((function(){}))},test:function(){var a=this;this.$refs["plantRadiationForm"].validate((function(e){if(!e)return!1;var t=Object.assign({},a.dataForm);a.currentPassword&&a.currentPassword!=t.password||delete t.password,u(t).then((function(e){0===e.resp_code?(a.$message({type:"success",message:"连接测试成功!"}),a.cancelClick()):a.$message({type:"error",message:e.resp_msg})})).catch((function(){}))}))},confirmClick:function(){var a=this;this.$refs["plantRadiationForm"].validate((function(e){if(!e)return!1;var t=Object.assign({},a.dataForm);a.currentPassword&&a.currentPassword!=t.password||delete t.password,"数据源添加"===a.modalOption.title?a.createMethod(t):a.updateMethod(t)}))},cancelClick:function(){this.$refs["plantRadiationForm"].resetFields(),this.modalOption.show=!1},synchronizeData:function(a){},deleteTableData:function(a){var e=this;this.$confirm("是否移除该数据源？","提示",{cancelButtonText:"取消",confirmButtonText:"确认",type:"warning"}).then((function(){var t=null===a||void 0===a?void 0:a.id;c(t).then((function(a){0===a.resp_code&&(e.$message({type:"success",message:"删除成功!"}),e.limit=10,e.page=1,e.getDataList())})).catch((function(){}))})).catch((function(){}))}}},h=m,g=(t("2dea"),t("2877")),f=Object(g["a"])(h,s,o,!1,null,"0de5ed0c",null);e["default"]=f.exports},"2dea":function(a,e,t){"use strict";t("3280d")},"3280d":function(a,e,t){}}]);