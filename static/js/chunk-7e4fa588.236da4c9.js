(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7e4fa588"],{"0e8f":function(e,t,r){"use strict";r.d(t,"c",(function(){return l})),r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return s})),r.d(t,"d",(function(){return i}));r("99af");var a=r("b775"),n="",l=function(){return Object(a["c"])("".concat(n,"/api-user/department/findAll"))},o=function(e){return Object(a["b"])("".concat(n,"/api-user/department/").concat(e))};function s(e){return Object(a["a"])({url:"".concat(n,"/api-user/department/saveOrUpdate"),method:"post",isJson:!0,data:JSON.stringify(e)})}var i=function(e){return Object(a["c"])("".concat(n,"/api-user/department/editName"),e)}},3183:function(e,t,r){},"349b":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("section",{staticClass:"search-container"},[r("el-form",{staticClass:"search-form-wrap",attrs:{size:"small","label-width":"80px","label-position":"right",model:e.searchForm}},[r("el-row",[r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"用户名"}},[r("el-input",{attrs:{placeholder:"用户名",clearable:""},model:{value:e.searchForm.username,callback:function(t){e.$set(e.searchForm,"username",t)},expression:"searchForm.username"}})],1)],1),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"显示名称"}},[r("el-input",{attrs:{placeholder:"显示名称",clearable:""},model:{value:e.searchForm.nickname,callback:function(t){e.$set(e.searchForm,"nickname",t)},expression:"searchForm.nickname"}})],1)],1),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"所属部门"}},[r("org-tree",{ref:"orgTreeDom",staticStyle:{width:"100%"},attrs:{"corp-id":e.corpId},model:{value:e.searchForm.departmentId,callback:function(t){e.$set(e.searchForm,"departmentId",t)},expression:"searchForm.departmentId"}})],1)],1),r("el-col",{attrs:{span:6}},[r("div",{staticClass:"search-form_btn"},[r("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.fnSearch}},[e._v("搜索")]),r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"primary"},on:{click:e.resetData}},[e._v("重置")]),r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:e.addUser}},[e._v("添加用户")])],1)])],1)],1)],1),r("div",{staticClass:"divide-line"}),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.tableData,border:""}},[r("el-table-column",{attrs:{prop:"username",label:"用户名",width:"120"}}),r("el-table-column",{attrs:{prop:"nickname",label:"显示名称"}}),r("el-table-column",{attrs:{prop:"mobile",label:"手机",width:"120"}}),r("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),r("el-table-column",{attrs:{prop:"mobile",label:"系统角色"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.roles,(function(t){return r("span",{key:t.id,staticClass:"span-roles"},[e._v(e._s(t.name))])}))}}])}),r("el-table-column",{attrs:{label:"账号启用",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{attrs:{"active-color":"#1E9FFF","inactive-color":"#BFBFBF"},on:{change:function(r){return e.switchClick(t.row)}},model:{value:t.row.enabled,callback:function(r){e.$set(t.row,"enabled",r)},expression:"scope.row.enabled"}})]}}])}),r("el-table-column",{attrs:{label:"操作",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.viewUserInfo(t.row)}}},[e._v("用户详细")]),r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.resetPwd(t.row)}}},[e._v("密码重置")]),r("el-button",{attrs:{type:"text",size:"small"}},[e._v("配置个人hive库")])]}}])})],1),r("div",{staticClass:"mt-20"},[r("el-pagination",{attrs:{"page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:e.count},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("user-detail",{ref:"userDetail",attrs:{parentRow:e.rowData}}),r("add-user",{ref:"createUser",attrs:{dialogId:e.dialogId}})],1)},n=[],l=r("7bbf"),o=r("c24f"),s=r("b775"),i="",c=function(e){return Object(s["c"])("".concat(i,"/api-user/users/findUsers"),e)},u=function(e){return Object(s["c"])("".concat(i,"/api-user/users/updateEnabled"),e)},m=function(e){return Object(s["c"])("".concat(i,"/api-user/department/fullName"),e)},d=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-dialog",{attrs:{title:"用户详情",visible:e.dialogShow,width:"30%",center:""},on:{"update:visible":function(t){e.dialogShow=t}}},[r("el-form",{staticClass:"form-wrap",attrs:{"label-position":"left","label-width":"100px"}},[r("el-form-item",{attrs:{label:"用户名："}},[r("span",{staticClass:"span-cl"},[e._v(" "+e._s(e.parentRow.username)+" ")])]),r("el-form-item",{attrs:{label:"显示名称："}},[r("span",{staticClass:"span-cl"},[e._v(" "+e._s(e.parentRow.nickname)+" ")])]),r("el-form-item",{attrs:{label:"性别："}},[r("span",{staticClass:"span-cl"},[e._v(" "+e._s("1"==e.parentRow.sex?"男":"女")+" ")])]),r("el-form-item",{attrs:{label:"手机："}},[r("span",{staticClass:"span-cl"},[e._v(" "+e._s(e.parentRow.mobile)+" ")])]),r("el-form-item",{attrs:{label:"邮箱："}},[r("span",{staticClass:"span-cl"},[e._v(" "+e._s(e.parentRow.email)+" ")])]),r("el-form-item",{attrs:{label:"系统角色："}},e._l(e.parentRow.roles,(function(t){return r("span",{key:t.id,staticClass:"span-cl"},[e._v(e._s(t.name))])})),0),r("el-form-item",{attrs:{label:"部门："}},[r("el-tooltip",{attrs:{content:e.allDepartment,placement:"top"}},[r("span",{staticClass:"span-cl"},[e._v(" "+e._s(e.parentRow.department)+" "),r("i",{staticClass:"el-icon-info"})])])],1),r("el-form-item",{attrs:{label:"创建时间："}},[r("span",{staticClass:"span-cl"},[e._v(" "+e._s(e._f("formateDate")(e.parentRow.createTime))+" ")])])],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogShow=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.okClick}},[e._v("确 定")])],1)],1)],1)},f=[],p={props:["parentRow"],data:function(){return{dialogShow:!1,allDepartment:""}},created:function(){},mounted:function(){},methods:{SonFunc:function(e){this.dialogShow=!0,this.fullNameFunc(e)},fullNameFunc:function(e){var t=this;m({departmentId:e}).then((function(e){t.allDepartment=e}))},okClick:function(){this.$props.parentRow}}},h=p,b=(r("7ba9"),r("2877")),g=Object(b["a"])(h,d,f,!1,null,"1bc7df58",null),v=g.exports,w=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-dialog",{key:e.dialogId,attrs:{title:"创建用户",visible:e.dialogShow,width:"30%",center:"","destroy-on-close":!0,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.dialogShow=t}}},[r("el-form",{ref:"userInfoForm",staticClass:"form-wrapper",attrs:{size:"small",model:e.form,rules:e.formRules,"label-position":"left","label-width":"120px"}},[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{attrs:{maxlength:20},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),r("el-form-item",{attrs:{label:"显示名称",prop:"nickname"}},[r("el-input",{attrs:{maxlength:20},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),r("el-form-item",{attrs:{label:"性别",prop:"sex"}},[r("el-radio-group",{model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[r("el-radio",{attrs:{label:0}},[e._v("女")]),r("el-radio",{attrs:{label:1}},[e._v("男")])],1)],1),r("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[r("el-input",{attrs:{maxlength:11},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{attrs:{maxlength:20},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),r("el-form-item",{attrs:{label:"系统角色",prop:"role"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{clearable:""},on:{change:e.fnChangeRole},model:{value:e.form.role,callback:function(t){e.$set(e.form,"role",t)},expression:"form.role"}},[e.roleList.length>0?e._l(e.roleList,(function(t){return r("el-option",{key:t.id,attrs:{value:t.name}},[e._v(" "+e._s(t.name)+" ")])})):e._e()],2)],1),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{maxlength:20},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),r("el-form-item",{attrs:{label:"密码强度"}},[r("el-steps",{attrs:{active:e.level}},[r("el-step",{attrs:{icon:"el-icon-circle-check"}}),r("el-step",{attrs:{icon:"el-icon-circle-check"}}),r("el-step",{attrs:{icon:"el-icon-circle-check"}})],1)],1),r("el-form-item",{attrs:{label:"确认密码",prop:"comfirmPassword"}},[r("el-input",{attrs:{maxlength:20},model:{value:e.form.comfirmPassword,callback:function(t){e.$set(e.form,"comfirmPassword",t)},expression:"form.comfirmPassword"}})],1),r("el-form-item",{attrs:{label:"所属部门",prop:"departmentId"}},[r("org-tree",{ref:"orgTreeDom",staticStyle:{width:"100%"},model:{value:e.form.departmentId,callback:function(t){e.$set(e.form,"departmentId",t)},expression:"form.departmentId"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.cancelClick}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.confirmClick}},[e._v("确定")])],1)],1)],1)},k=[],_=(r("a9e3"),r("498a"),r("7db0"),r("b0c0"),r("3f5e"),{components:{OrgTree:l["a"]},props:{dialogId:{type:Number}},watch:{dialogId:function(e,t){e!==t&&(this.form={username:"",nickname:"",sex:"",mobile:"",email:"",role:"",password:"",comfirmPassword:"",departmentId:0})}},data:function(){var e=this,t=function(t,r,a){var n=/^[A-Za-z0-9]+$/g,l=null===r||void 0===r?void 0:r.trim();""===l?a(new Error("请输入密码")):n.test(l)?l.length<4||l.length>20?a(new Error("请输入4-20位的字符")):(""!==e.form.comfirmPassword&&e.$refs.userInfoForm.validateField("comfirmPassword"),a()):a(new Error("请输入数字、字母"))},r=function(t,r,a){var n=/^[A-Za-z0-9]+$/g,l=null===r||void 0===r?void 0:r.trim();""===l?a(new Error("请输入确认密码")):n.test(l)?l.length<4||l.length>20?a(new Error("请输入4-20位的字符")):l!==e.form.password?a(new Error("确认密码与密码不一致!")):a():a(new Error("请输入数字、字母"))};return{dialogShow:!1,roleList:[],form:{username:"",nickname:"",sex:"",mobile:"",email:"",role:"",password:"",comfirmPassword:"",departmentId:0},formRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],nickname:[{required:!0,message:"请输入显示名称",trigger:"blur"}],sex:[{required:!0,message:"请选择性别",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{max:11,min:11,message:"手机号11位长度"},{validator:this.handleTelCheck}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:this.handleEmailCheck}],role:[{required:!0,message:"请选择系统角色",trigger:"blur"}],password:[{required:!0,validator:t,trigger:"blur"}],comfirmPassword:[{required:!0,validator:r,trigger:"blur"}],departmentId:[{required:!0,message:"请选择部门",trigger:"blur"}]}}},computed:{level:function(){var e,t=null===(e=this.form.password)||void 0===e?void 0:e.trim();return t?t.length>0&&t.length<=6?1:t.length>6&&t.length<=10?2:t.length>10&&t.length<=20?3:void 0:0}},created:function(){this.queryRoles()},methods:{handleTelCheck:function(e,t,r){var a=/(13\d|14[579]|15[^4\D]|17[^49\D]|18\d)\d{8}/;a.test(t)||r("请输入符合规范的手机号"),r()},handleEmailCheck:function(e,t,r){var a=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;a.test(t)||r("请输入符合规范的邮箱账号"),r()},queryRoles:function(){var e=this;Object(o["d"])({type:0}).then((function(t){0===(null===t||void 0===t?void 0:t.code)&&(e.roleList=(null===t||void 0===t?void 0:t.data)||[])})).catch((function(){}))},fnChangeRole:function(e){this.form.role=e;var t=this.roleList.find((function(t){return t.name===e}));this.curRoleId=t&&t.id},openDialog:function(){this.dialogShow=!0},cancelClick:function(){this.$refs["userInfoForm"].resetFields(),this.dialogShow=!1,this.form={}},confirmClick:function(){var e=this;this.$refs["userInfoForm"].validate((function(t){if(t){if(!e.curRoleId)return void e.$message({type:"warn",message:"请选择角色!"});var r={username:e.form.username,nickname:e.form.nickname,sex:e.form.sex,mobile:e.form.mobile,email:e.form.email,roleId:e.curRoleId,password:e.form.password,departmentId:e.form.departmentId};Object(o["a"])(r).then((function(t){0===t.resp_code&&(e.$message({type:"success",message:"修改成功!"}),e.$parent.queryCityList(),e.cancelClick())})).catch((function(){}))}}))}}}),y=_,C=(r("6a60"),Object(b["a"])(y,w,k,!1,null,"6ca5bf44",null)),x=C.exports,$={name:"SystemUserList",components:{userDetail:v,addUser:x,OrgTree:l["a"]},data:function(){return{corpId:1,searchForm:{username:"",nickname:"",departmentId:""},loading:!0,count:0,limit:10,page:1,rowData:{},tableData:[],dialogId:1}},mounted:function(){this.$refs["orgTreeDom"].fnClear(),this.getUserList()},methods:{getUserList:function(){var e=this;c({limit:this.limit,page:this.page,username:this.searchForm.username,nickname:this.searchForm.nickname,departmentId:this.searchForm.departmentId}).then((function(t){var r=t.data,a=t.count;e.tableData=r,e.count=a,e.loading=!1})).catch((function(){}))},handleSizeChange:function(e){this.limit=e,this.getUserList()},handleCurrentChange:function(e){this.page=e,this.getUserList()},fnSearch:function(){this.page=1,this.getUserList()},resetData:function(){var e=this;this.page=1,this.searchForm.username="",this.searchForm.nickname="",this.searchForm.departmentId="",this.$nextTick((function(){e.corpId=0,e.$refs["orgTreeDom"].fnClear()})),this.getUserList()},viewUserInfo:function(e){this.rowData=e,this.$refs.userDetail.SonFunc(e.departmentId)},resetPwd:function(e){var t=this;Object(o["g"])(e.id).then((function(e){0===e.resp_code&&t.$message({message:"密码重置成功！",type:"success"})})).catch((function(){}))},switchClick:function(e){var t=this;u({enabled:1==e.enabled,id:e.id}).then((function(e){t.$message({message:"操作成功！",type:"success"})})).catch((function(){}))},addUser:function(){this.dialogId++,this.$refs.createUser.openDialog()}}},I=$,F=(r("7139"),Object(b["a"])(I,a,n,!1,null,"437f556d",null));t["default"]=F.exports},"3f5e":function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var a=r("b775"),n="";function l(e){return Object(a["a"])({url:"".concat(n,"/api-file/files-anon"),method:"post",isFile:!0,data:e})}},"6a60":function(e,t,r){"use strict";r("7dbb")},7139:function(e,t,r){"use strict";r("d242")},"7ba9":function(e,t,r){"use strict";r("b443")},"7bbf":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-tree-select",{ref:"treeSelect",attrs:{loading:e.loading,clearable:e.clearable,"only-child":e.onlyChild,"tree-data":e.treeData},model:{value:e.currentValue,callback:function(t){e.currentValue=t},expression:"currentValue"}})},n=[],l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-select",{ref:"select",attrs:{value:e.currentValuet,loading:e.loading,clearable:e.clearable},on:{clear:e.clearData}},[r("el-option",{staticClass:"dropdown__tree",attrs:{value:0,label:e.currentLabel}},[r("el-tree",{ref:"tree",attrs:{data:e.treeData,props:e.defaultProps,"node-key":"id","highlight-current":"",accordion:"","default-expanded-keys":[e.pid]},on:{"node-click":e.handleNodeClick}})],1)],1)},o=[],s=(r("b0c0"),{components:{},name:"vTreeSelect",props:{value:{required:!0},loading:{type:Boolean},clearable:{type:Boolean},treeData:{required:!0,type:Array},onlyChild:{type:Boolean,default:!1}},data:function(){return{currentLabel:void 0,pid:void 0,defaultProps:{children:"subs",label:"name"}}},computed:{currentValuet:function(){if(this.pid="",null!==this.value&&void 0!==this.value){var e=this.currentNode(this.treeData,this.value);return this.pid=!0===e||void 0===e?"":e,0}this.pid=""}},methods:{currentNode:function(e,t){for(var r in e){if(e[r].id===t)return this.selectNode(e[r]),!0;if(e[r].subs&&e[r].subs.length>0){var a=this.currentNode(e[r].subs,t);if(void 0!==a)return!0===a?e[r].id:a}}},handleNodeClick:function(e){return(!this.onlyChild||(!e.subs||0===e.subs.length))&&this.$emit("input",parseInt(e.id))},selectNode:function(e){var t=this;this.$nextTick((function(){t.$refs["tree"].setCurrentKey(e.id)})),this.$refs["select"]&&(this.$refs["select"].visible=!1),this.currentLabel=e.name},clearData:function(){this.$emit("input",void 0)}}}),i=s,c=(r("80ad"),r("2877")),u=Object(c["a"])(i,l,o,!1,null,null,null),m=u.exports,d=r("0e8f"),f={name:"OrgTree",components:{vTreeSelect:m},props:{value:{required:!0},corpId:{required:!1},clearable:{type:Boolean},onlyChild:{type:Boolean}},computed:{currentValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},data:function(){return{loading:!1,treeData:[]}},methods:{refresh:function(){var e=this;this.loading=!0,Object(d["c"])().then((function(t){e.loading=!1,e.treeData=[{subs:t,id:0,name:"部门"}]}))},fnClear:function(){this.$refs["treeSelect"].clearData()}},created:function(){this.refresh()},mounted:function(){var e=this;this.$refs["treeSelect"].$on("nodeClick",(function(t){e.$emit("nodeClick",t)}))}},p=f,h=Object(c["a"])(p,a,n,!1,null,null,null);t["a"]=h.exports},"7dbb":function(e,t,r){},"80ad":function(e,t,r){"use strict";r("3183")},b443:function(e,t,r){},d242:function(e,t,r){}}]);